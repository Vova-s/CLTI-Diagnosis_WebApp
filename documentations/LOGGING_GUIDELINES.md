# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —â–æ–¥–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è - –©–æ –¥—ñ–π—Å–Ω–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ª–æ–≥—É–≤–∞—Ç–∏

## ‚ùå –©–æ –ó–ê–†–ê–ó –ª–æ–≥—É—î—Ç—å—Å—è –∑–∞–Ω–∞–¥—Ç–æ –±–∞–≥–∞—Ç–æ

### 1. RequestLoggingMiddleware - –ª–æ–≥—É—î –ö–û–ñ–ï–ù HTTP –∑–∞–ø–∏—Ç
**–ü—Ä–æ–±–ª–µ–º–∞**: –õ–æ–≥—É—î –ø–æ—á–∞—Ç–æ–∫ —ñ –∫—ñ–Ω–µ—Ü—å –ö–û–ñ–ù–û–ì–û –∑–∞–ø–∏—Ç—É (–≤–∫–ª—é—á–∞—é—á–∏ —Å—Ç–∞—Ç–∏—á–Ω—ñ —Ñ–∞–π–ª–∏, CSS, JS, –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è)

**–†—ñ—à–µ–Ω–Ω—è**: 
- ‚ùå –ü—Ä–∏–±—Ä–∞—Ç–∏ –∑ production –∞–±–æ –ª–æ–≥—É–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ –ø–æ–º–∏–ª–∫–∏
- ‚úÖ –ó–∞–ª–∏—à–∏—Ç–∏ —Ç—ñ–ª—å–∫–∏ –¥–ª—è API endpoints (/api/*)
- ‚úÖ –í–∏–∫–ª—é—á–∏—Ç–∏ —Å—Ç–∞—Ç–∏—á–Ω—ñ —Ñ–∞–π–ª–∏ (css, js, images, fonts)

### 2. AuthenticationDiagnosticMiddleware - –ª–æ–≥—É—î –î–í–Ü–ß–Ü
**–ü—Ä–æ–±–ª–µ–º–∞**: –õ–æ–≥—É—î BEFORE —ñ AFTER –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ API/Account –∑–∞–ø–∏—Ç—É –∑ –¥–µ—Ç–∞–ª—å–Ω–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ cookies —Ç–∞ claims

**–†—ñ—à–µ–Ω–Ω—è**:
- ‚ùå –ü—Ä–∏–±—Ä–∞—Ç–∏ –∑ production (—Ç—ñ–ª—å–∫–∏ –¥–ª—è development –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏)
- ‚úÖ –ê–±–æ –ª–æ–≥—É–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ Warning/Error —Ä—ñ–≤–Ω—ñ

### 3. AuthController - –Ω–∞–¥—Ç–æ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è
**–ü—Ä–æ–±–ª–µ–º–∞**: –õ–æ–≥—É—î –≤—Å—ñ —Å–ø—Ä–æ–±–∏ –≤—Ö–æ–¥—É (–≤–∫–ª—é—á–∞—é—á–∏ —É—Å–ø—ñ—à–Ω—ñ), –≤—Å—ñ refresh token –æ–ø–µ—Ä–∞—Ü—ñ—ó

**–©–æ –∑–∞–ª–∏—à–∏—Ç–∏**:
- ‚úÖ Failed login attempts (LogWarning) - –í–ê–ñ–õ–ò–í–û –¥–ª—è –±–µ–∑–ø–µ–∫–∏
- ‚úÖ Security events (password reset, token revocation) - –í–ê–ñ–õ–ò–í–û
- ‚ùå –£—Å–ø—ñ—à–Ω—ñ –ª–æ–≥–∏–Ω–∏ (LogInformation) - –ø—Ä–∏–±—Ä–∞—Ç–∏ –∞–±–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –Ω–∞ Debug
- ‚ùå –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —ñ—Å–Ω—É—é—á–∏—Ö refresh tokens - –ø—Ä–∏–±—Ä–∞—Ç–∏

### 4. UserService - –∑–∞–Ω–∞–¥—Ç–æ –±–∞–≥–∞—Ç–æ LogInformation
**–ü—Ä–æ–±–ª–µ–º–∞**: –õ–æ–≥—É—î –≤—Å—ñ —É—Å–ø—ñ—à–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó (update, change password, delete)

**–©–æ –∑–∞–ª–∏—à–∏—Ç–∏**:
- ‚úÖ LogWarning - –≤—Å—ñ –ø–æ–º–∏–ª–∫–∏ —Ç–∞ –Ω–µ–≤–∞–ª—ñ–¥–Ω—ñ —Å–ø—Ä–æ–±–∏ - –ó–ê–õ–ò–®–ò–¢–ò
- ‚úÖ LogError - –≤—Å—ñ –≤–∏–Ω—è—Ç–∫–∏ - –ó–ê–õ–ò–®–ò–¢–ò
- ‚ùå LogInformation - —É—Å–ø—ñ—à–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó - –ø—Ä–∏–±—Ä–∞—Ç–∏ –∞–±–æ Debug

## ‚úÖ –©–æ –ü–û–í–ò–ù–ù–û –ª–æ–≥—É–≤–∞—Ç–∏—Å—è (Best Practices)

### 1. Security Events (LogWarning/LogError)
**–ó–ê–í–ñ–î–ò –ª–æ–≥—É–≤–∞—Ç–∏**:
- ‚úÖ Failed authentication attempts (–∑ IP, email, timestamp)
- ‚úÖ Failed authorization attempts (–¥–æ—Å—Ç—É–ø –¥–æ –∑–∞—Ö–∏—â–µ–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤)
- ‚úÖ Password reset requests
- ‚úÖ Password change attempts (—É—Å–ø—ñ—à–Ω—ñ —Ç–∞ –Ω–µ–≤–¥–∞–ª—ñ)
- ‚úÖ Token revocation
- ‚úÖ Suspicious activity (–±–∞–≥–∞—Ç–æ –Ω–µ–≤–¥–∞–ª–∏—Ö —Å–ø—Ä–æ–±)

### 2. Errors (LogError)
**–ó–ê–í–ñ–î–ò –ª–æ–≥—É–≤–∞—Ç–∏**:
- ‚úÖ –í—Å—ñ –≤–∏–Ω—è—Ç–∫–∏ (exceptions) –∑ –ø–æ–≤–Ω–∏–º stack trace
- ‚úÖ Database errors
- ‚úÖ API errors
- ‚úÖ Authentication/Authorization errors

### 3. Business Events (LogInformation - —Ç—ñ–ª—å–∫–∏ –≤–∞–∂–ª–∏–≤—ñ)
**–õ–æ–≥—É–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ –∫–ª—é—á–æ–≤—ñ –ø–æ–¥—ñ—ó**:
- ‚úÖ User registration (—Ç—ñ–ª—å–∫–∏ —É—Å–ø—ñ—à–Ω–∞)
- ‚úÖ Critical business operations
- ‚ùå –ó–≤–∏—á–∞–π–Ω—ñ CRUD –æ–ø–µ—Ä–∞—Ü—ñ—ó - –ù–ï –ª–æ–≥—É–≤–∞—Ç–∏

### 4. Performance Monitoring (LogWarning/Debug)
**–î–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ**:
- ‚úÖ –ü–æ–≤—ñ–ª—å–Ω—ñ –∑–∞–ø–∏—Ç–∏ (> 1 —Å–µ–∫—É–Ω–¥–∞)
- ‚úÖ Database queries —â–æ —Ç—Ä–∏–≤–∞—é—Ç—å –¥–æ–≤–≥–æ
- ‚ùå –í—Å—ñ –∑–∞–ø–∏—Ç–∏ - –ù–ï –ª–æ–≥—É–≤–∞—Ç–∏

## üìã –†—ñ–≤–Ω—ñ –ª–æ–≥—É–≤–∞–Ω–Ω—è –∑–∞ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ–º

### Development
```
MinimumLevel: Debug (–¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏)
- LogDebug: OK (–¥–µ—Ç–∞–ª—å–Ω–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞)
- LogInformation: OK (–≤—Å—ñ –ø–æ–¥—ñ—ó)
- RequestLoggingMiddleware: OK
- AuthenticationDiagnosticMiddleware: OK
```

### Production
```
MinimumLevel: Warning (—Ç—ñ–ª—å–∫–∏ –ø—Ä–æ–±–ª–µ–º–∏)
- LogDebug: –ù–ï –ª–æ–≥—É–≤–∞—Ç–∏
- LogInformation: –¢—ñ–ª—å–∫–∏ –∫—Ä–∏—Ç–∏—á–Ω—ñ –ø–æ–¥—ñ—ó
- LogWarning: –í—Å—ñ –±–µ–∑–ø–µ–∫–æ–≤—ñ –ø–æ–¥—ñ—ó —Ç–∞ –ø—Ä–æ–±–ª–µ–º–∏
- LogError: –í—Å—ñ –ø–æ–º–∏–ª–∫–∏
- RequestLoggingMiddleware: –¢—ñ–ª—å–∫–∏ –ø–æ–º–∏–ª–∫–∏ –∞–±–æ –≤–∏–∫–ª—é—á–∏—Ç–∏
- AuthenticationDiagnosticMiddleware: –í–∏–∫–ª—é—á–∏—Ç–∏
```

## üîß –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ –∑–º—ñ–Ω–∏

### 1. –û–Ω–æ–≤–∏—Ç–∏ appsettings.json –¥–ª—è Production
```json
"MinimumLevel": {
  "Default": "Warning",  // –ó–º—ñ–Ω–∏—Ç–∏ –∑ Information
  "Override": {
    "Microsoft": "Warning",
    "Microsoft.AspNetCore": "Warning",
    "Microsoft.EntityFrameworkCore": "Warning",
    "CLTI.Diagnosis": "Warning",  // –ó–º—ñ–Ω–∏—Ç–∏ –∑ Information
    "System": "Warning"
  }
}
```

### 2. –í–∏–¥–∞–ª–∏—Ç–∏ –∞–±–æ –∑–º—ñ–Ω–∏—Ç–∏ Middleware
- RequestLoggingMiddleware: –õ–æ–≥—É–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ API endpoints –∞–±–æ —Ç—ñ–ª—å–∫–∏ –ø–æ–º–∏–ª–∫–∏
- AuthenticationDiagnosticMiddleware: –í–∏–¥–∞–ª–∏—Ç–∏ –∑ production, –∑–∞–ª–∏—à–∏—Ç–∏ —Ç—ñ–ª—å–∫–∏ –¥–ª—è development

### 3. –û–Ω–æ–≤–∏—Ç–∏ AuthController
- –£—Å–ø—ñ—à–Ω—ñ –ª–æ–≥–∏–Ω–∏: LogDebug –∑–∞–º—ñ—Å—Ç—å LogInformation
- Refresh token –æ–ø–µ—Ä–∞—Ü—ñ—ó: LogDebug –∞–±–æ –ø—Ä–∏–±—Ä–∞—Ç–∏
- –ó–∞–ª–∏—à–∏—Ç–∏ LogWarning –¥–ª—è –≤—Å—ñ—Ö failed attempts

### 4. –û–Ω–æ–≤–∏—Ç–∏ UserService
- –£—Å–ø—ñ—à–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó: LogDebug –∑–∞–º—ñ—Å—Ç—å LogInformation
- –ó–∞–ª–∏—à–∏—Ç–∏ LogWarning/LogError –¥–ª—è –ø–æ–º–∏–ª–æ–∫

## üéØ –ü—Ä–∞–≤–∏–ª–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è

**–õ–æ–≥—É–π —Ç—ñ–ª—å–∫–∏ —Ç–µ, —â–æ:**
1. ‚úÖ –ü–æ—Ç—Ä—ñ–±–Ω–æ –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º
2. ‚úÖ –í–∞–∂–ª–∏–≤–æ –¥–ª—è –±–µ–∑–ø–µ–∫–∏
3. ‚úÖ –ü–æ—Ç—Ä—ñ–±–Ω–æ –¥–ª—è –∞—É–¥–∏—Ç—É (security events)
4. ‚úÖ –í–∫–∞–∑—É—î –Ω–∞ –ø–æ–º–∏–ª–∫–∏ –∞–±–æ –ø—Ä–æ–±–ª–µ–º–∏

**–ù–ï –ª–æ–≥—É–π:**
1. ‚ùå –ó–≤–∏—á–∞–π–Ω—ñ —É—Å–ø—ñ—à–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó
2. ‚ùå –ö–æ–∂–µ–Ω HTTP –∑–∞–ø–∏—Ç
3. ‚ùå Debug —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –≤ production
4. ‚ùå –î–µ—Ç–∞–ª—ñ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É

## üìä –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—ñ—Å–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

**–ó–∞—Ä–∞–∑**: ~1000+ –∑–∞–ø–∏—Å—ñ–≤ –Ω–∞ –¥–µ–Ω—å (–∑–∞–Ω–∞–¥—Ç–æ –±–∞–≥–∞—Ç–æ)
**–ü—ñ—Å–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó**: ~50-100 –∑–∞–ø–∏—Å—ñ–≤ –Ω–∞ –¥–µ–Ω—å (—Ç—ñ–ª—å–∫–∏ –≤–∞–∂–ª–∏–≤—ñ –ø–æ–¥—ñ—ó)

**–ü–µ—Ä–µ–≤–∞–≥–∏**:
- ‚úÖ –ú–µ–Ω—à–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ –¥–∏—Å–∫
- ‚úÖ –®–≤–∏–¥—à–∏–π –ø–æ—à—É–∫ —É –ª–æ–≥–∞—Ö
- ‚úÖ –ú–µ–Ω—à–µ –æ–±—Å—è–≥ –ª–æ–≥-—Ñ–∞–π–ª—ñ–≤
- ‚úÖ –õ–µ–≥—à–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏ –ø—Ä–æ–±–ª–µ–º–∏
- ‚úÖ –ö—Ä–∞—â–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å

---

*–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –±–∞–∑—É—é—Ç—å—Å—è –Ω–∞ OWASP Logging Guide —Ç–∞ .NET Logging Best Practices*

